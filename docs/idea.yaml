framework_plan:
  name: yourfw # placeholder
  goal: >
    A Fiber-like Go framework with chaining pipeline,
    strict folder structure, Rails-style generators,
    and reusable logic modules for rapid API development.

# ----------------------------------------------------------
# 1. VISION / CORE IDEA
# ----------------------------------------------------------
vision:
  - simple_to_write: true
  - fiber_like_syntax: true
  - pipeline_chaining: true
  - strict_folder_structure: true
  - rails_like_generator: true
  - reusable_logic_blocks: true
  - rapid_api_development: true

# ----------------------------------------------------------
# 2. WHAT WE PLANNED
# ----------------------------------------------------------
planned_features:
  chaining_api:
    example: "api.GET('/ana').Auth().Logic1('id').Logic2('id2').Limit()"
    description: >
      Each method is a pipeline step. Developer writes minimal code.

  reusable_logic_modules:
    definition: >
      Logic1, Logic2, etc., live in /app/logic and can be reused across routes.
    example_signature: "func Logic1(param string) PipelineStep"

  pipeline_engine:
    type: "[]PipelineStep"
    order: "executed sequentially"
    context: "shared ctx.Store for data passing"

  auth:
    method: "Auth()"
    purpose: "Validate JWT and extract claims"

  rbac:
    method: "Role('admin', 'staff')"
    purpose: "Check user role against allowed roles"

  rate_limit:
    method: "RateLimit(bucket, max, window)"
    purpose: "Prevent abuse of specific routes"

  passing_data_between_logics:
    method: "ctx.Store[key] = value"
    usage: "Logic1 stores → Logic2 fetches"

  sql_execution:
    optional: true
    description: "Pipeline step for raw SQL or query builder"
    example: "SQL('SELECT * FROM table WHERE id=?', Param('id'))"

  minimal_pipeline:
    pipeline_order:
      - "Auth"
      - "RBAC"
      - "Logic1"
      - "Logic2"
      - "RateLimit"
      - "RespondJSON"

# ----------------------------------------------------------
# 3. WHAT WE GOT CLEAR
# ----------------------------------------------------------
clarified_decisions:
  - go_allows_custom_structure: true
  - framework_needs_strict_structure: true
  - logic_steps_are_simple_go_functions: true
  - ctx_store_allows_logic_passing_data: true
  - chaining_is_pipeline_registration: true
  - cli_generation_is_mandatory_for_dx: true
  - separate_logic_vs_controllers: true
  - no business_logic_in_controllers: true
  - every_route_is_just_chain_of_steps: true
  - pipeline_can_shortcircuit: true

# ----------------------------------------------------------
# 4. STRICT FOLDER STRUCTURE (RAILS-STYLE)
# ----------------------------------------------------------
folder_structure:
  app:
    controllers: "Route definitions, chaining only — no business logic"
    logic: "All modular logic steps (Logic1, Logic2, etc.)"
    models: "DB models or schema representation"
    services: "Reusable services (email, notifications, etc.)"
    middleware: "Custom middleware"
  config: "env, db config, jwt keys"
  db:
    migrations: "auto-generated by CLI"
    schema: "current DB schema"
  public: "static files"
  cmd:
    yourfw: "CLI tool binary and commands"
  internal:
    core: "pipeline engine, ctx, router"
    support: "helpers/utils"

# ----------------------------------------------------------
# 5. CLI (RUBY ON RAILS STYLE)
# ----------------------------------------------------------
cli_commands:
  - "yourfw new appname"
  - "yourfw serve"
  - "yourfw make:controller NAME"
  - "yourfw make:logic NAME"
  - "yourfw make:route NAME --path=/ --logic=L1,L2"
  - "yourfw make:resource NAME"
  - "yourfw make:model NAME"
  - "yourfw make:migration NAME"
  - "yourfw migrate"
  - "yourfw db:seed"

# ----------------------------------------------------------
# 6. AVAILABLE PIPELINE STEPS
# ----------------------------------------------------------
pipeline_steps:
  core:
    - Auth()
    - Role(...)
    - RateLimit(...)
    - Cache(...)
    - Validate(...)
    - SQL(...)
    - RespondJSON()
    - RespondText()
    - ErrorHandler()
    - Transaction()
    - Log()
  custom_logic:
    - Logic1(param)
    - Logic2(param)
    - ANY_user_defined_logic()

# ----------------------------------------------------------
# 7. FUTURE ADDITIONS / EXTENSIONS (OPTIONAL)
# ----------------------------------------------------------
future_possible_features:
  validation_engine:
    description: "Param validation like Validate('id').Int().Min(1)"
  caching:
    description: "Cache route output before running SQL/logic"
  events:
    description: "Pub/sub for async tasks"
  job_queue:
    description: "Queue jobs from logic steps"
  metrics:
    description: "Prometheus metrics per pipeline step"
  policy_system:
    description: "Policies like CanCreateUser(c *Ctx)"
  hot_reload:
    description: "Auto rebuild like nodemon"
  scaffolding_templates:
    description: "Custom templates for generating files"
  orm_support:
    optional: true
    description: "Light ORM or query builder"
  plugins:
    description: "Community plugins like rails gems"

# ----------------------------------------------------------
# 8. OPEN QUESTIONS / NEED DECISION
# ----------------------------------------------------------
open_questions:
  - name_for_framework: "yourfw / pulse / chainfw / boltgo?"
  - sql_style: "Raw SQL vs Query Builder vs ORM"
  - default_auth: "JWT only or pluggable?"
  - default_rate_limit_storage: "In-memory / Redis / DB"
  - should_routes_autoload: true_or_false
  - should_logic_autoload: true_or_false
  - migration_system: "raw SQL or DSL"
